# ì˜¥ìˆ˜ìˆ˜ ì„ ë¬¼ ê°€ê²© ì˜ˆì¸¡ íŒŒì´í”„ë¼ì¸

## ğŸ“Š ì „ì²´ ì›Œí¬í”Œë¡œìš°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Step 0: ê°ì„± ë¶„ì„ (ìµœì´ˆ 1íšŒ)                    â”‚
â”‚                        finbert.py                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   news_articles_corn.csv                    â”‚
        â”‚   (ì›ë³¸ ë‰´ìŠ¤: title, description, text)      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                    [FinBERT ê°ì„± ë¶„ì„]
                    - GPU í™˜ê²½ ê¶Œì¥
                    - transformers ëª¨ë¸
                              â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   corn_all_news_with_sentiment.csv          â”‚
        â”‚   + sentiment (positive/negative/neutral)    â”‚
        â”‚   + sentiment_confidence                     â”‚
        â”‚   + positive_score, negative_score           â”‚
        â”‚   + price_impact_score                       â”‚
        â”‚   + article_embedding (512ì°¨ì›)              â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Step 1: ëª¨ë¸ í•™ìŠµ                              â”‚
â”‚                        train.py                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   corn_all_news_with_sentiment.csv          â”‚
        â”‚   corn_future_price_processed.csv           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                  [preprocessing.py ì‚¬ìš©]
                  1. ë‰´ìŠ¤ ë°ì´í„° ì „ì²˜ë¦¬
                  2. ì¼ë³„ ë‰´ìŠ¤ ì§‘ê³„
                  3. ë‚ ì§œ ë³´ì • (ì£¼ë§/íœ´ì¼)
                  4. ë‰´ìŠ¤-ê°€ê²© ë³‘í•©
                  5. PCA ì°¨ì› ì¶•ì†Œ (512â†’50)
                  6. Lag í”¼ì²˜ ìƒì„±
                              â†“
                    [XGBoost í•™ìŠµ]
                    - í´ë˜ìŠ¤ ë¶ˆê· í˜• ì²˜ë¦¬
                    - 300 estimators
                              â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   models/                                    â”‚
        â”‚   â”œâ”€â”€ xgb_model.json                        â”‚
        â”‚   â”œâ”€â”€ pca_transformer.pkl                   â”‚
        â”‚   â””â”€â”€ feature_columns.json                  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Step 2: ì‹¤ì‹œê°„ ì¶”ë¡                             â”‚
â”‚                        inference.py                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   ìµœê·¼ ë‰´ìŠ¤ ë°ì´í„° (3ì¼ì¹˜)                    â”‚
        â”‚   + ìµœê·¼ ê°€ê²© ë°ì´í„° (5ì¼ì¹˜)                  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                  [preprocessing.py ì‚¬ìš©]
                  - ë™ì¼í•œ ì „ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸
                  - PCA: transformë§Œ ìˆ˜í–‰
                  - Lag í”¼ì²˜ ìƒì„±
                              â†“
                  [ì €ì¥ëœ ëª¨ë¸ ë¡œë“œ & ì˜ˆì¸¡]
                              â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   ì˜ˆì¸¡ ê²°ê³¼ (JSON)                           â”‚
        â”‚   {                                          â”‚
        â”‚     "prediction": 0 or 1,                   â”‚
        â”‚     "probability": 0.85,                    â”‚
        â”‚     "features_summary": {...}               â”‚
        â”‚   }                                          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   LangChain â†’ LLM ë³´ê³ ì„œ ìƒì„±                â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”‘ í•µì‹¬ í¬ì¸íŠ¸

### 1. finbert.py (ê°ì„± ë¶„ì„)
- **ì‹¤í–‰ ì‹œì **: ìƒˆ ë‰´ìŠ¤ ìˆ˜ì§‘ ì‹œì—ë§Œ
- **ì†Œìš” ì‹œê°„**: 1000ê±´ë‹¹ ì•½ 5-10ë¶„ (GPU ê¸°ì¤€)
- **ì¶œë ¥**: ê°ì„± ì ìˆ˜ + ì„ë² ë”©ì´ ì¶”ê°€ëœ CSV
- **ì˜ì¡´ì„±**: transformers, torch

### 2. train.py (ëª¨ë¸ í•™ìŠµ)
- **ì‹¤í–‰ ì‹œì **: ì£¼ê¸°ì  ì¬í•™ìŠµ (ì£¼ 1íšŒ ë˜ëŠ” ì›” 1íšŒ)
- **ì†Œìš” ì‹œê°„**: ì•½ 1-2ë¶„
- **ì¶œë ¥**: ëª¨ë¸ íŒŒì¼ 3ê°œ (model, pca, features)
- **ì˜ì¡´ì„±**: xgboost, sklearn

### 3. inference.py (ì‹¤ì‹œê°„ ì˜ˆì¸¡)
- **ì‹¤í–‰ ì‹œì **: ë§¤ì¼ ë˜ëŠ” ì‹¤ì‹œê°„
- **ì†Œìš” ì‹œê°„**: 1ì´ˆ ë¯¸ë§Œ
- **ì¶œë ¥**: JSON ì˜ˆì¸¡ ê²°ê³¼
- **ì˜ì¡´ì„±**: xgboost, sklearn (ê°€ë²¼ì›€)

## ğŸ¯ ì™œ ì´ë ‡ê²Œ ë¶„ë¦¬í–ˆë‚˜?

### âœ… finbert.py ë³„ë„ ìœ ì§€ ì´ìœ :
1. **ë¹„ìš© ì°¨ì´**: GPU í•„ìš” vs CPUë§Œìœ¼ë¡œ ê°€ëŠ¥
2. **ì‹¤í–‰ ë¹ˆë„**: í•œ ë²ˆ vs ìì£¼
3. **ì˜ì¡´ì„±**: ë¬´ê±°ìš´ transformers vs ê°€ë²¼ìš´ sklearn
4. **ì¬ì‚¬ìš©ì„±**: ì´ë¯¸ ê°ì„± ë¶„ì„ëœ CSV ìˆìœ¼ë©´ ìŠ¤í‚µ

### âœ… preprocessing.py ê³µí†µ ëª¨ë“ˆí™”:
1. **ì¼ê´€ì„±**: í•™ìŠµê³¼ ì¶”ë¡ ì—ì„œ ë™ì¼í•œ ì „ì²˜ë¦¬
2. **ìœ ì§€ë³´ìˆ˜**: í•œ ê³³ë§Œ ìˆ˜ì •í•˜ë©´ ì–‘ìª½ ë°˜ì˜
3. **í…ŒìŠ¤íŠ¸**: ì „ì²˜ë¦¬ ë¡œì§ ë…ë¦½ì  í…ŒìŠ¤íŠ¸ ê°€ëŠ¥

## ğŸ’¡ ì‹¤ì œ ìš´ì˜ ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: ìµœì´ˆ êµ¬ì¶•
```bash
# 1. ê°ì„± ë¶„ì„ (GPU ì„œë²„ì—ì„œ)
python finbert.py

# 2. ëª¨ë¸ í•™ìŠµ
python train.py

# 3. ì¶”ë¡  (ë°°í¬ ì„œë²„ì—ì„œ)
python inference.py
```

### ì‹œë‚˜ë¦¬ì˜¤ 2: ì¼ì¼ ì˜ˆì¸¡
```bash
# finbert.pyëŠ” ìŠ¤í‚µ (ì´ë¯¸ ê°ì„± ë¶„ì„ëœ CSV ì‚¬ìš©)
# train.pyë„ ìŠ¤í‚µ (ê¸°ì¡´ ëª¨ë¸ ì‚¬ìš©)

# ì¶”ë¡ ë§Œ ìˆ˜í–‰
python inference.py  # ë˜ëŠ” APIë¡œ í˜¸ì¶œ
```

### ì‹œë‚˜ë¦¬ì˜¤ 3: ìƒˆ ë‰´ìŠ¤ ì¶”ê°€ + ì¬í•™ìŠµ
```bash
# 1. ìƒˆ ë‰´ìŠ¤ ê°ì„± ë¶„ì„
python finbert.py

# 2. ëª¨ë¸ ì¬í•™ìŠµ
python train.py

# 3. ìƒˆ ëª¨ë¸ë¡œ ì¶”ë¡ 
python inference.py
```

## ğŸ”„ LangChain í†µí•© ì˜ˆì‹œ

```python
from inference import predict_next_day
import pandas as pd

# 1. ìµœê·¼ ë°ì´í„° ë¡œë“œ
news_data = load_recent_news()  # ìµœê·¼ 3ì¼
price_data = load_recent_prices()  # ìµœê·¼ 5ì¼

# 2. ì˜ˆì¸¡ ìˆ˜í–‰
result = predict_next_day(news_data, price_data)

# 3. LLM ë³´ê³ ì„œ ìƒì„±
prompt = f"""
ë‹¤ìŒ ì˜ˆì¸¡ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì˜¥ìˆ˜ìˆ˜ ê°€ê²© ì „ë§ ë³´ê³ ì„œë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”:

ì˜ˆì¸¡: {'ìƒìŠ¹' if result['prediction'] == 1 else 'í•˜ë½'}
ìƒìŠ¹ í™•ë¥ : {result['probability']:.2%}

ë¶„ì„ ë°ì´í„°:
- ë‰´ìŠ¤ ê¸°ì‚¬ ìˆ˜: {result['features_summary']['latest_news_count']}ê°œ
- í‰ê·  ê°ì„± ì ìˆ˜: {result['features_summary']['avg_sentiment']:.2f}
- ê°€ê²© ì˜í–¥ ì ìˆ˜: {result['features_summary']['avg_price_impact']:.2f}
- í˜„ì¬ ê°€ê²©: ${result['features_summary']['latest_price']:.2f}
"""

report = llm.generate(prompt)
print(report)
```
