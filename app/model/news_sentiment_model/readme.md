# ğŸŒ½ ì˜¥ìˆ˜ìˆ˜ ê°€ê²© ì˜ˆì¸¡ ì‹œìŠ¤í…œ (Corn Price Prediction System)

ë‰´ìŠ¤ ê¸°ë°˜ ë¨¸ì‹ ëŸ¬ë‹ ì•™ìƒë¸” ëª¨ë¸ì„ í™œìš©í•œ ì˜¥ìˆ˜ìˆ˜ ì„ ë¬¼ ê°€ê²© ì˜ˆì¸¡ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

## ğŸ“‹ ëª©ì°¨
- [í”„ë¡œì íŠ¸ ê°œìš”](#-í”„ë¡œì íŠ¸-ê°œìš”)
- [ì£¼ìš” íŠ¹ì§•](#-ì£¼ìš”-íŠ¹ì§•)
- [ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜](#-ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜)
- [ì„¤ì¹˜ ë°©ë²•](#-ì„¤ì¹˜-ë°©ë²•)
- [ì‚¬ìš© ë°©ë²•](#-ì‚¬ìš©-ë°©ë²•)
- [ì¶œë ¥ ë°ì´í„° êµ¬ì¡°](#-ì¶œë ¥-ë°ì´í„°-êµ¬ì¡°)
- [ëª¨ë¸ ì„¤ëª…](#-ëª¨ë¸-ì„¤ëª…)
- [íŒŒì¼ êµ¬ì¡°](#-íŒŒì¼-êµ¬ì¡°)

## ğŸ¯ í”„ë¡œì íŠ¸ ê°œìš”

ì´ ì‹œìŠ¤í…œì€ ì˜¥ìˆ˜ìˆ˜ ê´€ë ¨ ë‰´ìŠ¤ ê¸°ì‚¬ì™€ ê°€ê²© ë°ì´í„°ë¥¼ ë¶„ì„í•˜ì—¬ ë‹¤ìŒë‚ ì˜ ê°€ê²© ë°©í–¥(ìƒìŠ¹/í•˜ë½/ìœ ì§€)ì„ ì˜ˆì¸¡í•©ë‹ˆë‹¤. 

### ì „ì²´ ì›Œí¬í”Œë¡œìš°

```
ì›ë³¸ ë°ì´í„°                ì „ì²˜ë¦¬                í•™ìŠµ              ì˜ˆì¸¡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ë‰´ìŠ¤ CSV â”‚â”€â”€STEP 0â”€â”€â†’â”‚ê°ì„± ë¶„ì„â”‚â”€â”€STEP 1â†’â”‚ëª¨ë¸ í•™ìŠµâ”‚â”€STEP 2â†’â”‚ì¼ì¼ ì˜ˆì¸¡ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ ê°€ê²© CSV â”‚                                     â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**STEP 0 (ìµœì´ˆ 1íšŒ)**: ì›ë³¸ ë‰´ìŠ¤ ë°ì´í„° â†’ í•„í„°ë§ + ê°ì„± ë¶„ì„ â†’ í•™ìŠµ ë°ì´í„° ìƒì„±  
**STEP 1 (ìµœì´ˆ 1íšŒ ë˜ëŠ” ì¬í•™ìŠµ)**: í•™ìŠµ ë°ì´í„° â†’ 3ê°œ ëª¨ë¸ í•™ìŠµ â†’ ëª¨ë¸ ì €ì¥  
**STEP 2 (ì¼ì¼ ì‹¤í–‰)**: ë‰´ìŠ¤ + ê°€ê²© ë°ì´í„° â†’ ì˜ˆì¸¡ â†’ JSON ë³´ê³ ì„œ ìƒì„±

### í•µì‹¬ ê¸°ëŠ¥
- **ë‰´ìŠ¤ ê¸°ë°˜ ë¶„ì„**: ë‰´ìŠ¤ ê¸°ì‚¬ì˜ ì„ë² ë”©, ê°ì„± ì ìˆ˜, ì—”í‹°í‹° ì •ë³´ë¥¼ í™œìš©
- **ì•™ìƒë¸” ì˜ˆì¸¡**: 3ê°œì˜ íŠ¹í™”ëœ ëª¨ë¸ì„ ê²°í•©í•˜ì—¬ ì‹ ë¢°ë„ ë†’ì€ ì˜ˆì¸¡ ìˆ˜í–‰
- **ì¦ê±° ê¸°ë°˜ ì„¤ëª…**: ì˜ˆì¸¡ ê²°ê³¼ë¥¼ ë’·ë°›ì¹¨í•˜ëŠ” ë‰´ìŠ¤ ê¸°ì‚¬ ì œê³µ
- **ìë™í™”ëœ íŒŒì´í”„ë¼ì¸**: ì¼ì¼ ìë™ ì˜ˆì¸¡ ë° ë³´ê³ ì„œ ìƒì„±

## âœ¨ ì£¼ìš” íŠ¹ì§•

### 1. 3ì¤‘ ì•™ìƒë¸” ëª¨ë¸
- **Negative Model**: ê°€ê²© í•˜ë½ ê°ì§€ ì „ë¬¸ (2-class)
- **Positive Model**: ê°€ê²© ìƒìŠ¹ ê°ì§€ ì „ë¬¸ (2-class)
- **Tri Model**: 3ë°©í–¥ ë¶„ë¥˜ (ìƒìŠ¹/í•˜ë½/ìœ ì§€)

### 2. ë‹¤ì¸µ íŠ¹ì„± ì¶”ì¶œ
- **ì„ë² ë”©**: ê¸°ì‚¬(512ì°¨ì›) + ì—”í‹°í‹°(1024ì°¨ì›) + ê´€ê³„(1024ì°¨ì›)
- **ê°ì„± íŠ¹ì„±**: ê°€ê²© ì˜í–¥ë„, ê¸ì •/ë¶€ì •/ì¤‘ë¦½ ì ìˆ˜, ë‰´ìŠ¤ ê°œìˆ˜ ë“±
- **ê°€ê²© íŠ¹ì„±**: OHLC, ê±°ë˜ëŸ‰, EMA, ë³€ë™ì„±

### 3. Transformer ê¸°ë°˜ ì•„í‚¤í…ì²˜
- Multi-Head Attention ë©”ì»¤ë‹ˆì¦˜
- Feed-Forward Network
- Layer Normalization & Dropout

## ğŸ—ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ë‰´ìŠ¤ ë°ì´í„°     â”‚
â”‚  (CSV)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ë°ì´í„° ì „ì²˜ë¦¬   â”‚â—„â”€â”€â”€â”€â–ºâ”‚  ê°€ê²© ë°ì´í„°     â”‚
â”‚  (Preprocessor) â”‚      â”‚  (CSV)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      íŠ¹ì„± ì¶”ì¶œ & ë²¡í„°í™”          â”‚
â”‚  (Embedding + Sentiment + Price) â”‚
â”‚         (2576ì°¨ì›)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        ì•™ìƒë¸” ì˜ˆì¸¡ê¸°             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Negative Model         â”‚   â”‚
â”‚  â”‚  (í•˜ë½ ê°ì§€)            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Positive Model         â”‚   â”‚
â”‚  â”‚  (ìƒìŠ¹ ê°ì§€)            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Tri Model              â”‚   â”‚
â”‚  â”‚  (3-way ë¶„ë¥˜)           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      íˆ¬í‘œ ì „ëµ & ì‹ ë¢°ë„ ê³„ì‚°      â”‚
â”‚  (Voting Strategy + Confidence)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ì˜ˆì¸¡ ê²°ê³¼ JSON ìƒì„±           â”‚
â”‚  â€¢ ì˜ˆì¸¡ ë°©í–¥ & ì‹ ë¢°ë„            â”‚
â”‚  â€¢ ëª¨ë¸ë³„ ì„¸ë¶€ ê²°ê³¼              â”‚
â”‚  â€¢ ì¦ê±° ë‰´ìŠ¤ & ë°˜ëŒ€ ë‰´ìŠ¤         â”‚
â”‚  â€¢ ì‹œì¥ ë¶„ì„ ìš”ì•½                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ ì„¤ì¹˜ ë°©ë²•

### 1. í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜

```bash
pip install torch numpy pandas scikit-learn transformers tqdm
```

**ì£¼ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬:**
- `torch`: PyTorch ë”¥ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬
- `transformers`: FinBERT ê°ì„± ë¶„ì„ ëª¨ë¸
- `pandas`, `numpy`: ë°ì´í„° ì²˜ë¦¬
- `scikit-learn`: ì „ì²˜ë¦¬ (StandardScaler)
- `tqdm`: ì§„í–‰ìƒí™© í‘œì‹œ

### 2. ë°ì´í„° ì¤€ë¹„

ë‹¤ìŒ íŒŒì¼ë“¤ì„ ì¤€ë¹„í•©ë‹ˆë‹¤:

**í•„ìˆ˜ íŒŒì¼:**
- `news_articles_resources.csv`: ì›ë³¸ ë‰´ìŠ¤ ë°ì´í„°
  - í•„ìˆ˜ ì»¬ëŸ¼: `publish_date`, `title`, `filter_status`, `key_word`
  - ì„ íƒ ì»¬ëŸ¼: `description`, `all_text`, `article_embedding`, `entity_embedding`, `triple_embedding`, `named_entities`
  
- `corn_future_price.csv`: ê°€ê²© ë°ì´í„°
  - í•„ìˆ˜ ì»¬ëŸ¼: `time`, `open`, `high`, `low`, `close`, `Volume`, `EMA`

**ì¤‘ê°„ ìƒì„± íŒŒì¼:**
- `corn_all_news_with_sentiment.csv`: STEP 0ì—ì„œ ìë™ ìƒì„±ë¨ (ìˆ˜ë™ ì¤€ë¹„ ë¶ˆí•„ìš”)

## ğŸš€ ì‚¬ìš© ë°©ë²•

### STEP 0: ë°ì´í„° ì „ì²˜ë¦¬ (ìµœì´ˆ 1íšŒ)

ì›ë³¸ ë‰´ìŠ¤ ë°ì´í„°(`news_articles_resources.csv`)ë¥¼ í•™ìŠµ ê°€ëŠ¥í•œ í˜•íƒœë¡œ ì „ì²˜ë¦¬í•©ë‹ˆë‹¤.

```bash
python preprocess_news_data.py \
    --input news_articles_resources.csv \
    --output corn_all_news_with_sentiment.csv \
    --model_name ProsusAI/finbert
```

**ì´ ë‹¨ê³„ì—ì„œ ìˆ˜í–‰ë˜ëŠ” ì‘ì—…:**

1. **ë‰´ìŠ¤ í•„í„°ë§**
   - `filter_status == 'T'` ì¡°ê±´ ì ìš©
   - í‚¤ì›Œë“œ í•„í„°ë§: `corn AND (price OR demand OR supply OR inventory)`

2. **í…ìŠ¤íŠ¸ ê²°í•©**
   - `title` + `description` + (í•„ìš”ì‹œ) `all_text` ì¼ë¶€ ê²°í•©

3. **ê°ì„± ë¶„ì„ (FinBERT)**
   - ê¸ì •/ë¶€ì •/ì¤‘ë¦½ ë¶„ë¥˜
   - ê° ê°ì„±ì˜ í™•ë¥  ì ìˆ˜ ê³„ì‚°
   - `price_impact_score` ê³„ì‚° (positive_score - negative_score)

**ì¶œë ¥ íŒŒì¼:**
- `corn_all_news_with_sentiment.csv`: ê°ì„± ë¶„ì„ì´ ì™„ë£Œëœ ë°ì´í„°
  - ì¶”ê°€ ì»¬ëŸ¼: `sentiment`, `positive_score`, `negative_score`, `neutral_score`, `price_impact_score`

**ì „ì²˜ë¦¬ ì˜µì…˜:**
```bash
# í•„í„°ë§ ê±´ë„ˆë›°ê¸° (ì „ì²´ ë°ì´í„° ì‚¬ìš©)
python preprocess_news_data.py --skip_filter

# ê°ì„± ë¶„ì„ ê±´ë„ˆë›°ê¸° (ì´ë¯¸ ë¶„ì„ëœ ë°ì´í„°)
python preprocess_news_data.py --skip_sentiment

# ì»¤ìŠ¤í…€ í‚¤ì›Œë“œ íŒ¨í„´ ì‚¬ìš©
python preprocess_news_data.py --keyword_pattern "corn.*(price|market)"
```

### STEP 1: ëª¨ë¸ í•™ìŠµ

```bash
python train_models.py \
    --news_path corn_all_news_with_sentiment.csv \
    --price_path corn_future_price.csv \
    --output_dir trained_models/ \
    --num_epochs 50
```

**ì¶œë ¥ íŒŒì¼:**
- `trained_models/negative_model.pt`: í•˜ë½ ê°ì§€ ëª¨ë¸
- `trained_models/positive_model.pt`: ìƒìŠ¹ ê°ì§€ ëª¨ë¸
- `trained_models/tri_model.pt`: 3-way ë¶„ë¥˜ ëª¨ë¸
- `trained_models/scaler.pkl`: StandardScaler
- `trained_models/training_metadata.json`: í•™ìŠµ ë©”íƒ€ë°ì´í„°

**í•™ìŠµ ì„¤ì •:**
- `lookback_days=7`: ê³¼ê±° 7ì¼ê°„ì˜ ë‰´ìŠ¤ ë¶„ì„
- `threshold=0.005`: ê°€ê²© ë³€ë™ ì„ê³„ê°’ (0.5%)
- `train/test split`: 80/20 (ì‹œê°„ ìˆœì„œ ìœ ì§€)
- `class_weights`: í´ë˜ìŠ¤ ë¶ˆê· í˜• ìë™ ë³´ì •

### STEP 2: ì˜ˆì¸¡ ìˆ˜í–‰

#### ë‹¨ì¼ ë‚ ì§œ ì˜ˆì¸¡

```bash
# íŠ¹ì • ë‚ ì§œ ì˜ˆì¸¡
python daily_prediction_pipeline.py --date 2024-11-01

# ìµœê·¼ ë‚ ì§œ ìë™ ì˜ˆì¸¡
python daily_prediction_pipeline.py
```

#### ë°°ì¹˜ ì˜ˆì¸¡ (ë‚ ì§œ ë²”ìœ„)

```bash
python daily_prediction_pipeline.py \
    --start_date 2024-11-01 \
    --end_date 2024-11-10 \
    --output_dir outputs/
```

**ì˜µì…˜:**
- `--news_path`: ë‰´ìŠ¤ ë°ì´í„° ê²½ë¡œ (ê¸°ë³¸ê°’: corn_all_news_with_sentiment.csv)
- `--price_path`: ê°€ê²© ë°ì´í„° ê²½ë¡œ (ê¸°ë³¸ê°’: corn_future_price.csv)
- `--model_dir`: í•™ìŠµëœ ëª¨ë¸ ë””ë ‰í† ë¦¬ (ê¸°ë³¸ê°’: trained_models)
- `--output_dir`: ê²°ê³¼ ì €ì¥ ë””ë ‰í† ë¦¬ (ê¸°ë³¸ê°’: outputs)

## ğŸ“Š ì¶œë ¥ ë°ì´í„° êµ¬ì¡°

ì˜ˆì¸¡ ê²°ê³¼ëŠ” JSON íŒŒì¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤ (`news_prediction_YYYY-MM-DD.json`).

### ì£¼ìš” ì„¹ì…˜

#### 1. metadata
```json
{
  "base_date": "2024-11-01",          // ë¶„ì„ ê¸°ì¤€ ë‚ ì§œ
  "prediction_date": "2024-11-02",    // ì˜ˆì¸¡ ëŒ€ìƒ ë‚ ì§œ
  "generated_at": "2026-02-03 16:58:29",
  "lookback_days": 7                   // ê³¼ê±° ë‰´ìŠ¤ ë¶„ì„ ê¸°ê°„
}
```

#### 2. prediction
```json
{
  "direction": "ìƒìŠ¹",                 // ì˜ˆì¸¡ ë°©í–¥: ìƒìŠ¹/í•˜ë½/ìœ ì§€
  "confidence": 0.516,                 // ì‹ ë¢°ë„ (0~1)
  "agreement_level": "medium",         // í•©ì˜ ìˆ˜ì¤€: high/medium/low
  "probabilities": {
    "up": 0.437,
    "down": 0.25,
    "stable": 0.313
  }
}
```

#### 3. model_consensus
```json
{
  "ensemble_reasoning": "Bi ëª¨ë¸ë“¤ ì¤‘ë¦½, Tri ëª¨ë¸ ìƒìŠ¹ ì˜ˆì¸¡",
  "detailed_reasoning": "ì£¼ìš” ì´ìŠˆ (ì˜í–¥ë„ 0.92): US economy grew...",
  "model_details": {
    "negative_model": {
      "prediction": "not_up",          // í•˜ë½/ìœ ì§€ ì˜ˆì¸¡
      "confidence": 0.587,
      "probabilities": {
        "not_up": 0.587,
        "up": 0.413
      }
    },
    "positive_model": {
      "prediction": "not_down",        // ìƒìŠ¹/ìœ ì§€ ì˜ˆì¸¡
      "confidence": 0.796,
      "probabilities": {
        "not_down": 0.796,
        "down": 0.204
      }
    },
    "tri_model": {
      "prediction": "up",              // ìƒìŠ¹ ì˜ˆì¸¡
      "confidence": 0.437,
      "probabilities": {
        "down": 0.25,
        "up": 0.437,
        "stable": 0.313
      }
    }
  }
}
```

#### 4. evidence
ì˜ˆì¸¡ì„ ë’·ë°›ì¹¨í•˜ëŠ” ì¦ê±° ë‰´ìŠ¤ì™€ ë°˜ëŒ€ë˜ëŠ” ë‰´ìŠ¤ë¥¼ ê°ê° ì œê³µí•©ë‹ˆë‹¤.

```json
{
  "supporting_news": [
    {
      "article_id": 56058,
      "title": "US economy grew at a solid 2.8% pace...",
      "description": "The U.S. economy grew at a healthy 2.8%...",
      "sentiment": "positive",
      "impact_score": 0.923,
      "positive_score": 0.945,
      "negative_score": 0.022,
      "neutral_score": 0.034,
      "key_entities": []
    }
  ],
  "opposing_news": [
    {
      "article_id": 52555,
      "title": "Bunge's Profit Drops Less Than Expected...",
      "sentiment": "negative",
      "impact_score": -0.959,
      ...
    }
  ]
}
```

#### 5. market_analysis
```json
{
  "sentiment_summary": {
    "total_news_count": 30,
    "avg_price_impact": -0.122,
    "avg_positive_score": 0.287,
    "avg_negative_score": 0.409,
    "avg_neutral_score": 0.304,
    "positive_ratio": 0.3,
    "negative_ratio": 0.4,
    "neutral_ratio": 0.3
  },
  "price_info": {
    "current_close": 414.5,
    "current_volume": 197406,
    "volatility": 0.013,
    "ema": 429.600227014227
  }
}
```

## ğŸ¤– ëª¨ë¸ ì„¤ëª…

### 1. Negative Model (í•˜ë½ ê°ì§€ ëª¨ë¸)
- **ëª©ì **: ê°€ê²© í•˜ë½ ê°ì§€
- **í´ë˜ìŠ¤**: 2ê°œ (not_up, up)
- **Threshold**: +0.005 (0.5% ìƒìŠ¹)
- **í•´ì„**: 
  - `prediction=0` (not_up): í•˜ë½ ë˜ëŠ” ìœ ì§€ ì˜ˆìƒ
  - `prediction=1` (up): ìƒìŠ¹ ì˜ˆìƒ

### 2. Positive Model (ìƒìŠ¹ ê°ì§€ ëª¨ë¸)
- **ëª©ì **: ê°€ê²© ìƒìŠ¹ ê°ì§€ (ì—­ë°©í–¥ í•™ìŠµ)
- **í´ë˜ìŠ¤**: 2ê°œ (not_down, down)
- **Threshold**: -0.005 (0.5% í•˜ë½)
- **í•´ì„**:
  - `prediction=0` (not_down): ìƒìŠ¹ ë˜ëŠ” ìœ ì§€ ì˜ˆìƒ
  - `prediction=1` (down): í•˜ë½ ì˜ˆìƒ

### 3. Tri Model (3ë°©í–¥ ë¶„ë¥˜ ëª¨ë¸)
- **ëª©ì **: ëª…í™•í•œ ë°©í–¥ì„± ë¶„ë¥˜
- **í´ë˜ìŠ¤**: 3ê°œ (down, up, stable)
- **Threshold**: Â±0.005
- **í•´ì„**:
  - `prediction=0` (down): í•˜ë½
  - `prediction=1` (up): ìƒìŠ¹
  - `prediction=2` (stable): ìœ ì§€

### ì•™ìƒë¸” ì „ëµ (Voting Strategy)

3ê°œ ëª¨ë¸ì˜ ì˜ˆì¸¡ì„ í†µí•©í•˜ëŠ” íˆ¬í‘œ ì „ëµ:

#### Case 1: ê°•í•œ í•©ì˜ (High Agreement)
- 3ê°œ ëª¨ë¸ì´ ëª¨ë‘ ê°™ì€ ë°©í–¥ ì˜ˆì¸¡
- ì‹ ë¢°ë„: 3ê°œ ëª¨ë¸ í‰ê· 
- ì˜ˆ: Negative=ìƒìŠ¹, Positive=not_down, Tri=ìƒìŠ¹ â†’ **ìƒìŠ¹ ì˜ˆì¸¡**

#### Case 2: ì¤‘ê°„ í•©ì˜ (Medium Agreement)
- Bi ëª¨ë¸(Negative, Positive)ì´ ì¤‘ë¦½, Tri ëª¨ë¸ì´ ë°©í–¥ ê²°ì •
- ì‹ ë¢°ë„: Tri ëª¨ë¸ ì‹ ë¢°ë„ Ã— 0.8
- ì˜ˆ: Negative=not_up, Positive=not_down, Tri=ìƒìŠ¹ â†’ **ìƒìŠ¹ ì˜ˆì¸¡**

#### Case 3: ë¶€ë¶„ í•©ì˜
- 2ê°œ ëª¨ë¸ì´ ì¼ì¹˜, 1ê°œ ëª¨ë¸ì´ ë‹¤ë¥¸ ì˜ˆì¸¡
- ì‹ ë¢°ë„: ì¼ì¹˜í•˜ëŠ” ëª¨ë¸ í‰ê·  Ã— 0.7~1.0
- ì˜ˆ: Negative=ìƒìŠ¹, Tri=ìƒìŠ¹, Positive=í•˜ë½ â†’ **ìƒìŠ¹ ì˜ˆì¸¡ (ë¶€ë¶„ ì¶©ëŒ)**

#### Case 4: ë‚®ì€ í•©ì˜ (Low Agreement)
- Bi ëª¨ë¸ì´ ì •ë°˜ëŒ€ ì‹ í˜¸, Tri ëª¨ë¸ì´ ê²°ì •
- ì‹ ë¢°ë„: ë‚®ìŒ (0.5~0.6)
- ì˜ˆ: Negative=ìƒìŠ¹, Positive=í•˜ë½, Tri=ìƒìŠ¹ â†’ **ìƒìŠ¹ ì˜ˆì¸¡ (ëª¨ë¸ ê°„ ì¶©ëŒ)**

## ğŸ“ íŒŒì¼ êµ¬ì¡°

```
.
â”œâ”€â”€ preprocess_news_data.py            # ë°ì´í„° ì „ì²˜ë¦¬ ìŠ¤í¬ë¦½íŠ¸ (STEP 0)
â”œâ”€â”€ finbert.py                         # ê°ì„± ë¶„ì„ ëª¨ë“ˆ
â”œâ”€â”€ train_models.py                    # ëª¨ë¸ í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸ (STEP 1)
â”œâ”€â”€ ensemble_predictor.py              # ì•™ìƒë¸” ì˜ˆì¸¡ ëª¨ë“ˆ
â”œâ”€â”€ daily_prediction_pipeline.py       # ì¼ì¼ ì˜ˆì¸¡ íŒŒì´í”„ë¼ì¸ (STEP 2)
â”œâ”€â”€ README.md                          # ì´ íŒŒì¼
â”‚
â”œâ”€â”€ news_articles_resources.csv        # ì›ë³¸ ë‰´ìŠ¤ ë°ì´í„° (ì…ë ¥)
â”œâ”€â”€ corn_all_news_with_sentiment.csv   # ì „ì²˜ë¦¬ëœ ë‰´ìŠ¤ ë°ì´í„° (ì¤‘ê°„ ìƒì„±ë¬¼)
â”œâ”€â”€ corn_future_price.csv              # ê°€ê²© ë°ì´í„° (ì…ë ¥)
â”‚
â”œâ”€â”€ trained_models/                    # í•™ìŠµëœ ëª¨ë¸ (ì¶œë ¥)
â”‚   â”œâ”€â”€ negative_model.pt
â”‚   â”œâ”€â”€ positive_model.pt
â”‚   â”œâ”€â”€ tri_model.pt
â”‚   â”œâ”€â”€ scaler.pkl
â”‚   â””â”€â”€ training_metadata.json
â”‚
â””â”€â”€ outputs/                           # ì˜ˆì¸¡ ê²°ê³¼ (ì¶œë ¥)
    â”œâ”€â”€ news_prediction_2024-11-01.json
    â”œâ”€â”€ news_prediction_2024-11-02.json
    â””â”€â”€ ...
```

## ğŸ”¬ ê¸°ìˆ  ìŠ¤íƒ

- **ë”¥ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬**: PyTorch
- **ê°ì„± ë¶„ì„**: FinBERT (ProsusAI/finbert) via Transformers
- **ë°ì´í„° ì²˜ë¦¬**: Pandas, NumPy
- **ì „ì²˜ë¦¬**: scikit-learn (StandardScaler)
- **ëª¨ë¸ ì•„í‚¤í…ì²˜**: 
  - Multi-Head Attention
  - Feed-Forward Network
  - Layer Normalization
  - Dropout Regularization

## ğŸ“ˆ ëª¨ë¸ ì„±ëŠ¥

í•™ìŠµ ì‹œ ë‹¤ìŒ ì§€í‘œë“¤ì´ ì¶œë ¥ë©ë‹ˆë‹¤:

- **Training/Test Accuracy**: ë¶„ë¥˜ ì •í™•ë„
- **Confusion Matrix**: í˜¼ë™ í–‰ë ¬
- **Classification Report**: Precision, Recall, F1-Score
- **Class Weights**: í´ë˜ìŠ¤ ë¶ˆê· í˜• ë³´ì • ê°€ì¤‘ì¹˜

## âš™ï¸ í•˜ì´í¼íŒŒë¼ë¯¸í„°

### í•™ìŠµ íŒŒë¼ë¯¸í„°
- `hidden_dim`: 256
- `num_heads`: 8 (Attention)
- `dropout`: 0.3
- `learning_rate`: ì´ˆê¸° 0.001 (Adam optimizer)
- `batch_size`: 32
- `scheduler`: ReduceLROnPlateau

### ì „ì²˜ë¦¬ íŒŒë¼ë¯¸í„°
- `lookback_days`: 7ì¼
- `future_days`: 1ì¼ (ë‹¤ìŒë‚  ì˜ˆì¸¡)
- `threshold`: Â±0.005 (0.5%)

## ğŸ› ï¸ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ì¼ë°˜ì ì¸ ë¬¸ì œ

**0. ì „ì²˜ë¦¬ ë‹¨ê³„**

**ì›ë³¸ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ**
```
âŒ ì˜¤ë¥˜: íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: news_articles_resources.csv
```
â†’ ì›ë³¸ ë‰´ìŠ¤ ë°ì´í„° íŒŒì¼ì´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.

**í•„í„°ë§ ê²°ê³¼ê°€ ë¹„ì–´ìˆìŒ**
```
âŒ ì˜¤ë¥˜: í•„í„°ë§ ê²°ê³¼ê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤. ì¡°ê±´ì„ í™•ì¸í•˜ì„¸ìš”.
```
â†’ `filter_status` ë˜ëŠ” `key_word` ì»¬ëŸ¼ì˜ ë°ì´í„°ë¥¼ í™•ì¸í•˜ì„¸ìš”.
â†’ `--skip_filter` ì˜µì…˜ìœ¼ë¡œ í•„í„°ë§ì„ ê±´ë„ˆë›¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**í•„ìˆ˜ ì»¬ëŸ¼ì´ ì—†ìŒ**
```
âŒ ì˜¤ë¥˜: í•„ìˆ˜ ì»¬ëŸ¼ì´ ì—†ìŠµë‹ˆë‹¤: ['title', 'publish_date']
```
â†’ ì›ë³¸ ë°ì´í„°ì— ìµœì†Œí•œ `title`ê³¼ `publish_date` ì»¬ëŸ¼ì´ í•„ìš”í•©ë‹ˆë‹¤.

**1. í•™ìŠµ ë‹¨ê³„**

**ë°ì´í„°ê°€ ì—†ë‹¤ëŠ” ê²½ê³ **
```
ê²½ê³ : 2024-XX-XXì˜ ê°€ê²© ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.
ê²½ê³ : 2024-XX-XXì˜ ê´€ë ¨ ë‰´ìŠ¤ê°€ ì—†ìŠµë‹ˆë‹¤.
```
â†’ í•´ë‹¹ ë‚ ì§œì— ë°ì´í„°ê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.

**2. ì˜ˆì¸¡ ë‹¨ê³„**

**ëª¨ë¸ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ**
```
FileNotFoundError: [Errno 2] No such file or directory: 'trained_models/xxx.pt'
```
â†’ `train_models.py`ë¥¼ ë¨¼ì € ì‹¤í–‰í•˜ì—¬ ëª¨ë¸ì„ í•™ìŠµí•˜ì„¸ìš”.

**ì „ì²˜ë¦¬ëœ ë°ì´í„°ê°€ ì—†ìŒ**
```
FileNotFoundError: corn_all_news_with_sentiment.csv
```
â†’ `preprocess_news_data.py`ë¥¼ ë¨¼ì € ì‹¤í–‰í•˜ì—¬ ë°ì´í„°ë¥¼ ì „ì²˜ë¦¬í•˜ì„¸ìš”.

**ì„ë² ë”© íŒŒì‹± ì˜¤ë¥˜**
```
ê²½ê³ : 2024-XX-XXì˜ ìœ íš¨í•œ ì„ë² ë”©ì´ ì—†ìŠµë‹ˆë‹¤.
```
â†’ ë‰´ìŠ¤ ë°ì´í„°ì˜ ì„ë² ë”© ì»¬ëŸ¼ì´ ì˜¬ë°”ë¥¸ JSON í˜•ì‹ì¸ì§€ í™•ì¸í•˜ì„¸ìš”.

## ğŸ“ ë¼ì´ì„ ìŠ¤

ì´ í”„ë¡œì íŠ¸ëŠ” ë‚´ë¶€ ì‚¬ìš©ì„ ìœ„í•œ ê²ƒì…ë‹ˆë‹¤.

## ğŸ‘¥ ê¸°ì—¬

íŒ€ì›ë“¤ê³¼ í•¨ê»˜ ê°œë°œí•œ í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.

---

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2026-02-03
