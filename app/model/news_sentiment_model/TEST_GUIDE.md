# Inference í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ

## ğŸ¯ ëª©ì 

2025-11-15ì˜ ì˜¥ìˆ˜ìˆ˜ ê°€ê²©ì„ ì˜ˆì¸¡í•˜ê¸° ìœ„í•´:
- **ì…ë ¥ ë‰´ìŠ¤**: 2025-11-12 ~ 2025-11-14 (3ì¼ì¹˜)
- **ì…ë ¥ ê°€ê²©**: 2025-11-14 ì´ì „ ìµœê·¼ 10ì¼ì¹˜
- **ì˜ˆì¸¡ íƒ€ê²Ÿ**: 2025-11-15

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### ë°©ë²• 1: ê°„ë‹¨ ë²„ì „ (ì¶”ì²œ)
```bash
# 1ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ë°ì´í„° ì¶”ì¶œ
python extract_test_data_simple.py

# 2ë‹¨ê³„: ì˜ˆì¸¡ ìˆ˜í–‰
python test_inference.py
```

### ë°©ë²• 2: ìƒì„¸ ë²„ì „
```bash
# 1ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ë°ì´í„° ì¶”ì¶œ (ìƒì„¸ ì •ë³´ í¬í•¨)
python prepare_inference_test_data.py

# 2ë‹¨ê³„: ì˜ˆì¸¡ ìˆ˜í–‰
python test_inference.py
```

## ğŸ“ ìƒì„±ë˜ëŠ” íŒŒì¼

### 1ë‹¨ê³„ í›„:
- `test_news_data.csv` - 2025-11-12~14 ë‰´ìŠ¤ (ì•½ 3ì¼ì¹˜)
- `test_price_data.csv` - ìµœê·¼ 10ì¼ì¹˜ ê°€ê²© ë°ì´í„°

### 2ë‹¨ê³„ í›„:
- `test_inference_result.json` - ì˜ˆì¸¡ ê²°ê³¼ (JSON)

## ğŸ“Š ì˜ˆìƒ ì¶œë ¥

### ë°ì´í„° ì¶”ì¶œ (extract_test_data_simple.py)
```
ë‰´ìŠ¤ ë°ì´í„° ì¶”ì¶œ ì¤‘...
âœ“ ì¶”ì¶œëœ ë‰´ìŠ¤: 15 ê±´

ê°€ê²© ë°ì´í„° ì¶”ì¶œ ì¤‘...
âœ“ ì¶”ì¶œëœ ê°€ê²©: 10 ê±´
âœ“ ê¸°ê°„: 2025-11-04 ~ 2025-11-14

ì™„ë£Œ! ë‹¤ìŒ íŒŒì¼ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤:
  - test_news_data.csv
  - test_price_data.csv
```

### ì˜ˆì¸¡ ìˆ˜í–‰ (test_inference.py)
```
============================================================
ì˜ˆì¸¡ ê²°ê³¼
============================================================

íƒ€ê²Ÿ ë‚ ì§œ: 2025-11-15
ì˜ˆì¸¡: ìƒìŠ¹ (1)
ì‹ ë¢°ë„: 78.50%

í”¼ì²˜ ìš”ì•½:
  - ë‰´ìŠ¤ ê¸°ì‚¬ ìˆ˜: 15 ê°œ
  - í‰ê·  ê°ì„± ì ìˆ˜: 0.723
  - í‰ê·  ê°€ê²© ì˜í–¥: 0.156
  - ìµœê·¼ ê°€ê²©: $425.50
  - ì‚¬ìš©ëœ ë°ì´í„°: 10 ì¼

ê·¼ê±° ë‰´ìŠ¤ (2ê°œ):
------------------------------------------------------------

[ë‰´ìŠ¤ 1]
ì œëª©: Corn prices surge on strong export demand
ë‚ ì§œ: 2025-11-14
ê°€ê²© ì˜í–¥ ì ìˆ˜: 0.856
ë‚´ìš©: Strong export demand from China...

[ë‰´ìŠ¤ 2]
ì œëª©: Weather concerns support corn market
ë‚ ì§œ: 2025-11-13
ê°€ê²© ì˜í–¥ ì ìˆ˜: 0.734
ë‚´ìš©: Dry weather conditions in Argentina...

ì‹¤ì œ 2025-11-15 ë°ì´í„°:
  ì¢…ê°€: $428.25
  ì „ì¼ ì¢…ê°€: $425.50
  ë³€í™”ìœ¨: +0.65%

ì˜ˆì¸¡ vs ì‹¤ì œ:
  ì˜ˆì¸¡: 1 (ìƒìŠ¹)
  ì‹¤ì œ: 1 (ìƒìŠ¹ (0.5% ì´ˆê³¼))
  ê²°ê³¼: âœ“ ì •ë‹µ!
```

## ğŸ” íŒŒì¼ êµ¬ì¡°

```
.
â”œâ”€â”€ corn_all_news_with_sentiment.csv   # ì›ë³¸ ë‰´ìŠ¤ (í•„ìˆ˜)
â”œâ”€â”€ corn_future_price.csv              # ì›ë³¸ ê°€ê²© (í•„ìˆ˜)
â”œâ”€â”€ models/                             # í•™ìŠµëœ ëª¨ë¸ (í•„ìˆ˜)
â”‚   â”œâ”€â”€ xgb_model.json
â”‚   â”œâ”€â”€ pca_transformer.pkl
â”‚   â””â”€â”€ feature_columns.json
â”‚
â”œâ”€â”€ extract_test_data_simple.py        # ê°„ë‹¨í•œ ë°ì´í„° ì¶”ì¶œ
â”œâ”€â”€ prepare_inference_test_data.py     # ìƒì„¸í•œ ë°ì´í„° ì¶”ì¶œ
â”œâ”€â”€ test_inference.py                  # ì˜ˆì¸¡ ì‹¤í–‰
â”‚
â”œâ”€â”€ test_news_data.csv                 # ìƒì„±ë¨
â”œâ”€â”€ test_price_data.csv                # ìƒì„±ë¨
â””â”€â”€ test_inference_result.json         # ìƒì„±ë¨
```

## ğŸ“ ìƒì„¸ ì„¤ëª…

### extract_test_data_simple.py
**ê¸°ëŠ¥:**
- ë‰´ìŠ¤: 2025-11-12 ~ 2025-11-14 í•„í„°ë§
- ê°€ê²©: 2025-11-14 ì´ì „ ìµœê·¼ 10ì¼ ì¶”ì¶œ
- CSV íŒŒì¼ ìƒì„±

**ì¶œë ¥:**
- `test_news_data.csv`
- `test_price_data.csv`

### prepare_inference_test_data.py
**ê¸°ëŠ¥:**
- `extract_test_data_simple.py`ì˜ ëª¨ë“  ê¸°ëŠ¥
- ì¶”ê°€ë¡œ ìƒì„¸í•œ í†µê³„ ì •ë³´ ì¶œë ¥
- ë‚ ì§œë³„ ë‰´ìŠ¤ ë¶„í¬ í™•ì¸
- ì‹¤ì œ 2025-11-15 ë°ì´í„° ë¯¸ë¦¬ í™•ì¸ (ìˆë‹¤ë©´)
- `test_inference.py` ìŠ¤í¬ë¦½íŠ¸ ìë™ ìƒì„±

**ì¶œë ¥:**
- `test_news_data.csv`
- `test_price_data.csv`
- `test_inference.py` (ì´ë¯¸ ìˆë‹¤ë©´ ë®ì–´ì“°ê¸°)

### test_inference.py
**ê¸°ëŠ¥:**
1. í…ŒìŠ¤íŠ¸ ë°ì´í„° ë¡œë“œ ë° ê²€ì¦
2. ëª¨ë¸ ë¡œë“œ (`models/` í´ë”)
3. ì˜ˆì¸¡ ìˆ˜í–‰ (ê·¼ê±° ë‰´ìŠ¤ í¬í•¨)
4. ì‹¤ì œ ë°ì´í„°ì™€ ë¹„êµ (ìˆë‹¤ë©´)
5. ê²°ê³¼ JSON ì €ì¥

**ì…ë ¥:**
- `test_news_data.csv`
- `test_price_data.csv`
- `models/` (í•™ìŠµëœ ëª¨ë¸)

**ì¶œë ¥:**
- ì½˜ì†” ì¶œë ¥ (ì˜ˆì¸¡ ê²°ê³¼)
- `test_inference_result.json`

## âš ï¸ ì£¼ì˜ì‚¬í•­

### 1. ëª¨ë¸ì´ ì—†ëŠ” ê²½ìš°
```bash
ì˜¤ë¥˜: ëª¨ë¸ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

ë‹¤ìŒì„ í™•ì¸í•˜ì„¸ìš”:
  1. models/ í´ë”ê°€ ìˆëŠ”ê°€?
  2. models/xgb_model.json íŒŒì¼ì´ ìˆëŠ”ê°€?

ëª¨ë¸ì´ ì—†ë‹¤ë©´ ë¨¼ì € í•™ìŠµì„ ìˆ˜í–‰í•˜ì„¸ìš”:
  python train.py
```

**í•´ê²°:**
```bash
python train.py
```

### 2. ë‰´ìŠ¤ ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°
```bash
âš ï¸ í•´ë‹¹ ë‚ ì§œì— ë‰´ìŠ¤ê°€ ì—†ìŠµë‹ˆë‹¤.
   ë‚ ì§œë¥¼ ì¡°ì •í•˜ì—¬ ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”.
```

**í•´ê²°:**
- `extract_test_data_simple.py` ë˜ëŠ” `prepare_inference_test_data.py` ìˆ˜ì •
- ë‚ ì§œ ë²”ìœ„ ë³€ê²½:
```python
# ì˜ˆ: 2025-11-10 ~ 2025-11-12ë¡œ ë³€ê²½
test_news = news_df[
    (news_df['publish_date'] >= '2025-11-10') &
    (news_df['publish_date'] <= '2025-11-12')
].copy()
```

### 3. ì‹¤ì œ ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°
```bash
âš ï¸ 2025-11-15 ì‹¤ì œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.
   ì˜ˆì¸¡ë§Œ ìˆ˜í–‰ë˜ì—ˆìœ¼ë©° ì •ë‹µ í™•ì¸ì€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.
```

**ì°¸ê³ :** ì˜ˆì¸¡ì€ ì •ìƒì ìœ¼ë¡œ ìˆ˜í–‰ë˜ì§€ë§Œ, ì •ë‹µ í™•ì¸ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.

## ğŸ”§ ì»¤ìŠ¤í„°ë§ˆì´ì§•

### ë‚ ì§œ ë²”ìœ„ ë³€ê²½
```python
# extract_test_data_simple.py ìˆ˜ì •

# ë‰´ìŠ¤ ë‚ ì§œ ë³€ê²½
test_news = news_df[
    (news_df['publish_date'] >= '2025-11-10') &  # ì‹œì‘ì¼
    (news_df['publish_date'] <= '2025-11-12')    # ì¢…ë£Œì¼
].copy()

# ê°€ê²© ê¸°ì¤€ì¼ ë³€ê²½
test_price = price_df[price_df['time'] <= '2025-11-12'].tail(10)

# test_inference.pyì—ì„œ íƒ€ê²Ÿ ë‚ ì§œ ë³€ê²½
target_date = '2025-11-13'  # ì˜ˆì¸¡í•  ë‚ ì§œ
```

### ê·¼ê±° ë‰´ìŠ¤ ê°œìˆ˜ ë³€ê²½
```python
# test_inference.py ìˆ˜ì •

result = predict_with_evidence(
    news_data=test_news,
    price_history=test_price,
    target_date=target_date,
    top_k=3  # 2ê°œ â†’ 3ê°œë¡œ ë³€ê²½
)
```

### ê°€ê²© ë°ì´í„° ì¼ìˆ˜ ë³€ê²½
```python
# extract_test_data_simple.py ìˆ˜ì •

# 10ì¼ â†’ 15ì¼ë¡œ ë³€ê²½
test_price = price_df[price_df['time'] <= '2025-11-14'].tail(15)
```

## ğŸ“Š ê²°ê³¼ í•´ì„

### ì˜ˆì¸¡ ê°’
- **0**: í•˜ë½ (0.5% ì´í•˜ ìƒìŠ¹ ë˜ëŠ” í•˜ë½)
- **1**: ìƒìŠ¹ (0.5% ì´ˆê³¼ ìƒìŠ¹)

### ì‹ ë¢°ë„ (confidence)
- `0.50 ~ 0.60`: ë‚®ìŒ (ë¶ˆí™•ì‹¤)
- `0.60 ~ 0.75`: ì¤‘ê°„
- `0.75 ~ 0.90`: ë†’ìŒ
- `0.90 ~ 1.00`: ë§¤ìš° ë†’ìŒ

### ê°€ê²© ì˜í–¥ ì ìˆ˜ (price_impact_score)
- **ì–‘ìˆ˜ (+)**: ê¸ì •ì  ë‰´ìŠ¤ (ê°€ê²© ìƒìŠ¹ ìš”ì¸)
- **ìŒìˆ˜ (-)**: ë¶€ì •ì  ë‰´ìŠ¤ (ê°€ê²© í•˜ë½ ìš”ì¸)
- **ì ˆëŒ“ê°’**: ì˜í–¥ë ¥ í¬ê¸°

## ğŸ› ë¬¸ì œ í•´ê²°

### ë¬¸ì œ: "ModuleNotFoundError: No module named 'inference'"
**í•´ê²°:**
```bash
# inference.pyê°€ ê°™ì€ í´ë”ì— ìˆëŠ”ì§€ í™•ì¸
ls -la inference.py

# ì—†ë‹¤ë©´ í”„ë¡œì íŠ¸ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ë¡œ ì´ë™
cd /path/to/project
python test_inference.py
```

### ë¬¸ì œ: "KeyError: 'article_embedding'"
**í•´ê²°:**
- `corn_all_news_with_sentiment.csv`ê°€ ì˜¬ë°”ë¥¸ íŒŒì¼ì¸ì§€ í™•ì¸
- ê°ì„± ë¶„ì„ì´ ì™„ë£Œëœ íŒŒì¼ì¸ì§€ í™•ì¸
```bash
# ê°ì„± ë¶„ì„ ë‹¤ì‹œ ì‹¤í–‰
python run_sentiment_analysis.py
```

### ë¬¸ì œ: "ValueError: ì „ì²˜ë¦¬ í›„ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤"
**í•´ê²°:**
- ë‰´ìŠ¤ ë°ì´í„°ê°€ ë„ˆë¬´ ì ìŒ (ìµœì†Œ 3ì¼ì¹˜ í•„ìš”)
- ë‚ ì§œ ë²”ìœ„ë¥¼ ëŠ˜ë¦¬ê±°ë‚˜ ë°ì´í„° í™•ì¸
```python
# 5ì¼ì¹˜ë¡œ ë³€ê²½
test_news = news_df[
    (news_df['publish_date'] >= '2025-11-10') &
    (news_df['publish_date'] <= '2025-11-14')
].copy()
```

## ğŸ“ˆ ë‹¤ìŒ ë‹¨ê³„

í…ŒìŠ¤íŠ¸ê°€ ì„±ê³µí•˜ë©´:
1. ë‹¤ë¥¸ ë‚ ì§œë¡œ í…ŒìŠ¤íŠ¸
2. ì„±ëŠ¥ í‰ê°€ (ì •í™•ë„ ì¸¡ì •)
3. ì‹¤ì‹œê°„ ì˜ˆì¸¡ íŒŒì´í”„ë¼ì¸ êµ¬ì¶•
4. LangChain í†µí•©í•˜ì—¬ ë³´ê³ ì„œ ìë™ ìƒì„±

## ğŸ’¡ íŒ

1. **ì—¬ëŸ¬ ë‚ ì§œ í…ŒìŠ¤íŠ¸**: ë‚ ì§œë¥¼ ë°”ê¿”ê°€ë©° ì—¬ëŸ¬ ë²ˆ í…ŒìŠ¤íŠ¸í•˜ì—¬ ëª¨ë¸ ì„±ëŠ¥ í™•ì¸
2. **ê°ì„± ë¶„í¬ í™•ì¸**: ë‰´ìŠ¤ ê°ì„±ì´ í¸í–¥ë˜ì§€ ì•Šì•˜ëŠ”ì§€ í™•ì¸
3. **ì‹œì¥ ë³€ë™ì„±**: ë³€ë™ì„±ì´ í° ê¸°ê°„ê³¼ ì‘ì€ ê¸°ê°„ì„ ë‚˜ëˆ ì„œ í…ŒìŠ¤íŠ¸
4. **ê²°ê³¼ ì €ì¥**: JSON íŒŒì¼ì„ ëª¨ì•„ì„œ ì„±ëŠ¥ ë¶„ì„

## ğŸ“ ì§€ì›

ë¬¸ì œê°€ ê³„ì†ë˜ë©´:
1. `test_inference_result.json` í™•ì¸
2. ì˜¤ë¥˜ ë©”ì‹œì§€ ì „ì²´ ë³µì‚¬
3. ë°ì´í„° íŒŒì¼ í™•ì¸ (í–‰ ìˆ˜, ì»¬ëŸ¼ëª…)
